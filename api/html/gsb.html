<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.10.0" />
<title>gsb API documentation</title>
<meta name="description" content="" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Module <code>gsb</code></h1>
</header>
<section id="section-intro">
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python"># IMPORTANT setup :
# set FLASK_APP   = &lt;nom_du_script&gt; (sans l&#39;extention)
# set FLASK_ENV   = development | production (default = production)
# set FLASK_DEBUG = true | false (default = false)
# in code exemple : app.config[&#39;DEBUG&#39;] = True
# liste conf      : https://flask.palletsprojects.com/en/2.0.x/config/

# commandes utiles :
# flask run -h 127.0.0.1 -p 3000 # demmarre le serveur avec l&#39;host &#39;localhost&#39; et sur le port 3000

from flask import Flask
from flask import jsonify
from flask import url_for
from flask import request
from flask import abort
from flask import redirect
from flask import Response
from flask import session
# from flask.ext.session import Session

from html import escape
from random import randint

from faker import Faker
from faker.providers import DynamicProvider


import pyodbc
import json
import datetime
import hashlib
import unicodedata
import sys
import logging 

app = Flask(__name__)
app.config.from_object(__name__)
app.config[&#39;ENV&#39;] = &#39;development&#39;
app.config[&#39;PERMANENT_SESSION_LIFETIME&#39;] = 365
app.secret_key = &#39;secret&#39;
app.config[&#39;DATABASE&#39;] = &#39;MYSQL&#39;

logging.basicConfig(filename=&#39;log/api2.log&#39;, level=logging.DEBUG, format=f&#39;%(asctime)s %(levelname)s %(name)s %(threadName)s : %(message)s&#39;)

# Session(app

@app.route(&#39;/&#39;)
def hello():
    &#34;&#34;&#34;
    S&#39;execute lorsqu&#39;on appelle la racine du serveur.
    Redirige vers la route /links.
    
    &#34;&#34;&#34;

    return redirect(&#34;/links&#34;, code=302)

@app.route(&#34;/links&#34;)
def list_routes():
    &#34;&#34;&#34;
    Liste les routes existantes dans l&#39;API.
    
    Returns:
        Un DOM HTML.
    &#34;&#34;&#34;
    session[&#39;id&#39;] = 0
    session[&#39;admin&#39;] = 2
    routes = &#39;&#39;

    for rule in app.url_map.iter_rules():
        routes += &#34;&lt;a href=&#39;&#34; + str(rule) + &#34;&#39;&gt;&#34; + escape(str(rule)) + &#34;&lt;/a&gt;&#34;
        routes += &#34;&lt;br&gt;&#34;

    return routes


def log(text, loglevel=0):
    &#34;&#34;&#34;
    Fonction de logging.

    Args:
        text (string): le message du log
    &#34;&#34;&#34;
    loglevel_label = {0 : &#34;INFO    &#34;, 1 : &#34;WARNING &#34;, 2 : &#34;ERROR   &#34;}

    date_heure = datetime.datetime.now().strftime(&#34;%d/%m/%Y %H:%M:%S&#34;)
    if &#34;username&#34; in session :
        username   = session[&#34;username&#34;].ljust(24)
    else:
        username   = &#34;None&#34;.ljust(24)
    url        = request.full_path.ljust(20)
    radr       = request.remote_addr
    entete     = date_heure + &#34; &#34; + username + &#34; &#34; + url + &#34; &#34; + radr + &#34; &#34;
    log        = entete + loglevel_label[loglevel] + text +&#34;\n&#34;
    with open(&#34;log/api.log&#34;, &#34;a&#34;) as f:
        f.write(log)

def get_session():
    &#34;&#34;&#34; 
    Check si l&#39;utilisateur s&#39;est connecté avant d&#39;accéder à une ressource (fonction appelée à chaque route).

    Returns:
        bool: l&#39;utilisateur est bien connecté
        erreur: code http 401
    &#34;&#34;&#34;
    if not &#34;id&#34; in session:
        log(&#34;A tenté d&#39;acceder à une ressource sans être connecté&#34;)
        abort(401)
    elif str(session[&#39;admin&#39;]) == &#39;0&#39;:
        log(&#34;l&#39;utilisateur n&#39;est pas autorisé à accéder à cette ressource&#34;)
        abort(401)
    log(&#34;l&#39;utilisateur à accedé à une ressources&#34;)
    return True

def remove_accents(input_str):
    &#34;&#34;&#34;
    Purge une chaine de caractères en enlevants les accents.

    Args:
        input_str (string): la chaine à purger
    
    Returns:
        string: input_str sans accents
    &#34;&#34;&#34;
    nkfd_form = unicodedata.normalize(&#39;NFKD&#39;, input_str)
    return u&#34;&#34;.join([c for c in nkfd_form if not unicodedata.combining(c)])

def connexion(db_name):
    &#34;&#34;&#34;
    Fonction de connexion à la base de donnée, elle est appelé à chaque nouvelle connexion.\n
    !!! Le driver ODBC SQLite3 est necessaire à son execution.\n
    !!! La base de donnée doit impérativement se trouver dans ./BDD/

    Args:
        db_name (string): le nom de la base de donnée à laquelle se connecter
    
    Returns:
        object: objet pyodbc 
    &#34;&#34;&#34;
    
    
    if app.config[&#39;DATABASE&#39;] == &#39;SQLITE&#39;:
        dir_path = &#39;./BDD/&#39;
        db_path  = dir_path + db_name
        cnxn = pyodbc.connect(&#34;Driver=SQLite3 ODBC Driver;Database=&#34; + db_path)
    
    elif app.config[&#39;DATABASE&#39;] == &#39;MYSQL&#39;:
        username = &#34;gsb&#34;
        password = &#34;157rmllp&#34;
        database = &#34;Applivisiteur&#34;
        driver   = &#34;MariaDB ODBC 3.0 Driver&#34;
        server   = &#34;localhost&#34;
        cnxn = pyodbc.connect(f&#34;Driver={driver};Database={database};Server={server};Uid={username};pwd={password}&#34;)

    elif app.config[&#39;DATABASE&#39;] == &#39;HOME&#39;:
        username = &#34;root&#34;
        password = &#34;157rmllp&#34;
        database = &#34;applivisiteur&#34;
        driver   = &#34;MySQL ODBC 8.0 Unicode Driver&#34;
        server   = &#34;localhost&#34;
        cnxn = pyodbc.connect(f&#34;Driver={driver};Database={database};Server={server};Uid={username};pwd={password}&#34;)
    
    return cnxn

def query(sql, arg=[], many=False):
    &#34;&#34;&#34;
    Fonction générale utilisée pour executer les requtêtes sql sur la base de donnée

    Args:
        sql  (string): Ordre SQL à executer
        arg  (list, optional): Liste des arguments de la requête SQL
        many (bool, optional): booleen qui indique si il faut executer la requete pour chaques éléments de arg
    
    Returns:
        dict: Retourne un dictionnaire avec le nom des champs de la table en clé et la valeur du champ en valeur.
        bool: Si il n&#39;y a aucun résultat à la requête retourne False
    &#34;&#34;&#34;
    try:
        cnxn   = connexion(&#39;api.db&#39;)
        cursor = cnxn.cursor()
    except pyodbc.Error as e:
        log(f&#34;error : {e}&#34;, 2)
        abort(500, f&#34;error : {e}&#34;)

    try:
        if arg:
            
            if many:
                cursor.executemany(sql,arg)
            else:
                cursor.execute(sql,*arg)    
        else:
            cursor.execute(sql)
    except pyodbc.Error as e:
        log(f&#39;error with query : \n {sql} \n |{arg}|&#39;, 2)
        cursor.rollback()
        log(f&#34;error : {e}&#34;, 2)
        abort(500, f&#34;error : {e}&#34;)

    cnxn.commit()

    if sql.split(&#34; &#34;)[0].upper() == &#34;INSERT&#34;:
        if app.config[&#39;DATABASE&#39;] in (&#34;HOME&#34;, &#34;MYSQL&#34;):
            cursor.execute(&#34;SELECT LAST_INSERT_ID()&#34;)
            res = cursor.fetchone()
            results = res[0]
        elif app.config[&#39;DATABASE&#39;] == &#34;SQLITE&#34;:
            sql = &#34;SELECT seq FROM sqlite_sequence WHERE name = &#39;Compte_rendu&#39;&#34;
            results = query(sql)[&#34;seq&#34;]

    else:

        try:
            res = cursor.fetchall()

            columns = [column[0] for column in cursor.description]
            results = []
            
            if len(res) &gt; 1:
                for row in res:
                    results.append(dict(zip(columns, row)))
            else:
                results = dict(zip(columns, res[0]))
        except Exception as e:
            results = 0

    cnxn.close()
    
    return results

@app.route(&#34;/ping&#34;)
def ping():
    &#34;&#34;&#34;
    Appelée pour tester la connexion à l&#39;API
    &#34;&#34;&#34;
    log(&#39;PING&#39;)
    return &#34;Alive !&#34;,200

@app.route(&#34;/GSB/medecin/&lt;int:Id&gt;/&#34;)
def medecin(Id):
    &#34;&#34;&#34;
    Execute une recherche de praticien.

    Args:
        Id (int): id du praticien concerné
    
    Returns:
        string: JSON avec toutes les informations du praticien
    &#34;&#34;&#34;
    get_session()
    sql = &#34;SELECT * FROM Praticiens WHERE Id = &#34; + str(Id) 
    results = query(sql)

    if not results :
        return Response(&#39;{&#34;erreur&#34; : &#34;Aucun enregistrement pour l\&#39;ID &#39; + str(Id) + &#39;&#34;}&#39;, status=404, mimetype=&#39;application/json&#39;)
    
    return Response(json.dumps(results), status=200, mimetype=&#39;application/json&#39;)
@app.route(&#34;/GSB/medecins&#34;)  #Praticiens
def medecin_all():
    &#34;&#34;&#34;
    Execute une recherche sur tout les praticiens.
    
    Returns:
        string: JSON avec toutes les informations de tous les praticiens
    &#34;&#34;&#34;
    get_session()
    sql = &#34;SELECT * from Praticiens ORDER BY Nom&#34;

    results = query(sql)
    
    return Response(json.dumps(results), status=200, mimetype=&#39;application/json&#39;)


@app.route(&#34;/GSB/medicaments&#34;)
def medicaments():
    &#34;&#34;&#34;
    Execute une recherche sur tout les médicaments.
    
    Returns:
        string: JSON avec toutes les informations de tous les médicaments
    &#34;&#34;&#34;
    get_session()
    sql = &#34;SELECT * FROM Medicaments&#34;

    result = query(sql)
    if result == 0:
        return Response(&#39;{&#34;error&#34; : &#34;Aucun enregistrement pour l\&#39;ID &#39; + str(Id) + &#39;&#34;}&#39;, status=404, mimetype=&#39;application/json&#39;)

    return Response(json.dumps(result), status=200, mimetype=&#39;application/json&#39;)
@app.route(&#34;/GSB/medicament/&lt;int:Id&gt;/&#34;)
def medicament(Id):
    &#34;&#34;&#34;
    Execute une recherche de médicament.

    Args:
        Id (int): id du médicament concerné
    
    Returns:
        string: JSON avec toutes les informations du médicament
    &#34;&#34;&#34;
    get_session()
    sql = &#34;SELECT * FROM Medicaments WHERE Id = &#34; + str(Id)

    result = query(sql)
    if result == 0:
        return Response(&#39;{&#34;error&#34; : &#34;Aucun enregistrement pour l\&#39;ID &#39; + str(Id) + &#39;&#34;}&#39;, status=404, mimetype=&#39;application/json&#39;)

    return Response(json.dumps(result), status=200, mimetype=&#39;application/json&#39;)


@app.route(&#34;/GSB/CR/medecin/&lt;int:Id&gt;/&#34;)
def cr_by_medecin(Id):
    &#34;&#34;&#34;
    Recherche de compte rendu par medecin.
    
    Args:
        Id (int): id du medecin
    
    Returns:
        string: JSON contenant toutes les informations du compte rendu ainsi que les échantillons associés
    &#34;&#34;&#34;
    get_session()
    sql_CR = &#34;&#34;&#34;
    SELECT CR.Id, M.Civilite || &#39; &#39; || M.Nom || &#39; &#39; || M.Prenom AS Medecin,  CR.Date, CR.Motif, CR.Bilan
    FROM Compte_rendu CR
    JOIN Praticiens M ON CR.Medecin_id = M.Id
    WHERE CR.Medecin_id = &#34;&#34;&#34; + str(Id)

    result_CR = query(sql_CR) 
    if not result_CR:
        return Response(&#39;{&#34;error&#34; : &#34;Aucun enregistrement pour l\&#39;ID &#39; + str(Id) + &#39;&#34;}&#39;, status=404, mimetype=&#39;application/json&#39;)

    cpt = 0
    for cr in result_CR : 
        sql_Medoc = &#34;&#34;&#34;
        SELECT Medicaments.Label, Echantillons.Nombre
        FROM Echantillons
        JOIN Medicaments ON Echantillons.Medicaments_id = Medicaments.Id
        WHERE Echantillons.CR_id = &#34;&#34;&#34; + str(cr[&#34;Id&#34;])

        result_Medoc = query(sql_Medoc)

        if result_Medoc:
            result_CR[cpt][&#34;Medoc&#34;] = result_Medoc
        
        cpt+=1
    
    return Response(json.dumps(result_CR), status=200, mimetype=&#39;application/json&#39;)

@app.route(&#34;/GSB/CR/visiteur&#34;)
def cr_by_visiteur():
    &#34;&#34;&#34;
    Recherche de compte rendu par visiteur.

    Returns:
       string: JSON contenant toutes les informations du compte rendu ainsi que les échantillons associés 
    &#34;&#34;&#34;
    get_session()
    if app.config[&#34;DATABASE&#34;] == &#34;SQLITE&#34;:
        sql_CR = &#34;&#34;&#34;
        SELECT CR.Id, M.Civilite || &#39; &#39; || M.Nom || &#39; &#39; || M.Prenom AS Medecin,  CR.Date, CR.Motif, CR.Bilan
        FROM Compte_rendu CR
        JOIN Praticiens M ON CR.Medecin_id = M.Id
        WHERE CR.Visiteur_id = &#34;&#34;&#34; + str(session[&#34;id&#34;])
    else:
        sql_CR = &#34;&#34;&#34;
        SELECT CR.Id, CONCAT(M.Civilite,&#39; &#39;,M.Nom,&#39; &#39;,M.Prenom) AS Medecin,  CR.Date, CR.Motif, CR.Bilan
        FROM Compte_rendu CR
        JOIN Praticiens M ON CR.Medecin_id = M.Id
        WHERE CR.Visiteur_id = &#34;&#34;&#34; + str(session[&#34;id&#34;])


    result_CR = query(sql_CR)
    # print(result_CR)
    result_CR = {cr[&#34;Id&#34;] : cr for cr in result_CR}
    # print(result_CR)
    if not result_CR:
        return Response(&#39;{&#34;error&#34; : &#34;Aucun enregistrement pour l\&#39;utilisateur &#39; + str(session[&#34;id&#34;]) + &#39;&#34;}&#39;, status=200, mimetype=&#39;application/json&#39;)
    cpt = 0
    for Id in result_CR :
        cr = result_CR[Id]
        sql_Medoc = &#34;&#34;&#34;
        SELECT Medicaments.Label, Echantillons.Nombre
        FROM Echantillons
        JOIN Medicaments ON Echantillons.Medicaments_id = Medicaments.Id
        WHERE Echantillons.CR_id = &#34;&#34;&#34; + str(cr[&#34;Id&#34;])

        result_Medoc = query(sql_Medoc)
        if result_Medoc:

            if isinstance(result_Medoc,  dict):
                result_CR[Id][&#34;Medoc&#34;] = [result_Medoc]
            else:
                result_CR[Id][&#34;Medoc&#34;] = result_Medoc

        else:
            result_CR[Id][&#34;Medoc&#34;] = []
        cpt+=1
    
    return Response(json.dumps(result_CR), status=200, mimetype=&#39;application/json&#39;)

@app.route(&#34;/GSB/CR/Insert&#34;, methods=[&#39;POST&#39;])
def Insert_CR():
    &#34;&#34;&#34;
    fonction pour créer un compte rendu, la route attend un JSON 

    method:
        POST

    Param:
        JSON : contient les informations du compte rendu, il doit comporter les champs [&#34;Medecin&#34;, &#34;Date&#34;, &#34;Motif&#34;, &#34;Bilan&#34;, &#34;Medoc&#34;]
    
    Returns:
        HTTP CODE: 201, 400
    &#34;&#34;&#34;
    get_session()
    cr = request.get_json()
    
    if not cr :
        if request.headers[&#39;Content-Type&#39;] != &#39;application/json&#39;:
                return &#39;Le Content-Type doit être application/json&#39;, 400
        else :
                abort(400)

    filtre = [&#34;Medecin&#34;, &#34;Date&#34;, &#34;Motif&#34;, &#34;Bilan&#34;, &#34;Medoc&#34;]

    for el in filtre:
        if el not in cr.keys():
                return &#39;Il manque &#34;&#39;+ el +&#39;&#34; dans le JSON&#39;, 400
    try:
        datetime.datetime.strptime(cr[&#34;Date&#34;], &#34;%d/%m/%Y&#34;)
    except ValueError:
        return &#34;La Date n&#39;est pas au bon format, le bon format est : DD/MM/YYYY&#34;, 400

    # print(cr)
    
    # exemple : {&#34;Medecin&#34;: 1, &#34;Date&#34;: &#34;21/07/2021&#34;, &#34;Motif&#34;: &#34;Visite&#34;, &#34;Bilan&#34;: &#34;Bla Bla Bla...&#34;, &#34;Medoc&#34;: {&#34;1&#34;: 1, &#34;2&#34; : 1, &#34;3&#34; : 5}}
    
    query_CR    = &#34;INSERT INTO Compte_rendu(Medecin_id, Date, Motif, Bilan, Visiteur_id) VALUES (?,?,?,?,? )&#34;
    Id = query(query_CR, (cr[&#34;Medecin&#34;], cr[&#34;Date&#34;], cr[&#34;Motif&#34;], cr[&#34;Bilan&#34;], session[&#34;id&#34;]))

    if cr[&#34;Medoc&#34;] :
        query_Medoc = &#34;INSERT INTO Echantillons(Medicaments_id, Cr_id, Nombre) VALUES (?,?,?)&#34;
        Medoc_list  = []
        for medoc_id, nombre in cr[&#34;Medoc&#34;].items():
            Medoc_list += [(medoc_id, Id, nombre)]

        query(query_Medoc, Medoc_list, many=True)

    log(f&#34;Compte rendu inséré avec l&#39;id : {Id}&#34;)

    return f&#34;Compte rendu inséré avec l&#39;id : {Id}&#34;, 201

@app.route(&#34;/GSB/visiteur/secteur_id/&lt;int:Id&gt;/&#34;)
def secteur_by_visiteur(Id):
    &#34;&#34;&#34;
    Recherche de Secteur par visiteur.
    
    Args:
        Id (int): id du visiteur
    
    Returns:
        integer: id du secteur
    &#34;&#34;&#34;
    sql_sect = &#34;&#34;&#34;
    SELECT Secteur_id
    FROM Visiteurs
    WHERE id = &#34;&#34;&#34; + str(Id)


    result_sect = query(sql_sect)
    return str(result_sect[&#34;Secteur_id&#34;])
    cursor.close()


@app.route(&#34;/GSB/connexion&#34;, methods=[&#39;GET&#39;])
def se_connecter():
    &#34;&#34;&#34;
    Route utilisée pour s&#39;authentifier auprès de l&#39;API
    
    Returns:
        HTTP CODE: 200, 401
    &#34;&#34;&#34;
    ressources = request.get_json()
    res      = query(&#34;SELECT password, id, Secteur_id, nom, prenom, admin FROM Visiteurs WHERE login = ? &#34;, (ressources[&#39;login&#39;],) )

    password      = ressources[&#34;password&#34;]
    hash_password = hashlib.md5(password.encode(&#34;utf-8&#34;)).hexdigest()


    if res:
        user_pass = res[&#34;password&#34;]
        if user_pass == hash_password:
            session[&#39;username&#39;] = ressources[&#39;login&#39;]
            session[&#39;id&#39;]       = res[&#39;id&#39;]
            session[&#39;secteur&#39;]  = res[&#39;Secteur_id&#39;]
            session[&#39;admin&#39;]    = res[&#39;admin&#39;]
            
            info_util = dict()
            info_util[&#34;id&#34;]      = res[&#34;id&#34;]
            info_util[&#34;nom&#34;]     = res[&#34;nom&#34;]
            info_util[&#34;prenom&#34;]  = res[&#34;prenom&#34;]
            info_util[&#39;secteur&#39;] = res[&#39;Secteur_id&#39;]

            log(&#34;UTILISATEUR CONNECTE&#34;)
            
            return Response(json.dumps(info_util), status=200, mimetype=&#39;application/json&#39;)
            return str(res[&#34;id&#34;])
        else:
            log(&#34;Tentative de connexion avec : &#34; + ressources[&#34;login&#34;])
            return &#34;Mauvais nom d&#39;utilisateur/mot de passe&#34;, 401
    else:
        log(&#34;Tentative de connexion avec : &#34; + ressources[&#34;login&#34;])
        return &#34;Mauvais nom d&#39;utilisateur/mot de passe&#34;, 401

@app.route(&#34;/utils/hashpass/&lt;password&gt;/&#34;)
def hashpass(password):
    &#34;&#34;&#34;
    Affiche le hash d&#39;une chaine de charatère

    Args:
        password(string): mot de passe à asher
    
    Returns:
        string: le mot de passe ashé
    &#34;&#34;&#34;
    
    hash_password = hashlib.md5(password.encode(&#34;utf-8&#34;)).hexdigest()

    return str(hash_password)

###OUTILS DE GENERATION DE DONNEE POUR GSB#########

@app.route(&#34;/faker/praticien&#34;)
def fake_prat():
    &#34;&#34;&#34;
    Génère 50 faux particiens
    &#34;&#34;&#34;
    fake = Faker(&#34;fr_FR&#34;)
    provider = DynamicProvider(provider_name=&#34;civilite&#34;, elements=[&#34;Mr&#34;, &#34;Me&#34;])
    fake.add_provider(provider)

    for i in range(50):
        fake_adress = fake.address().split(&#39;\n&#39;) # [&#39;chemin Jacqueline Noël&#39;, &#39;22704 ThomasVille&#39;]
        
        fake_ville   = fake_adress[1].split(&#39; &#39;)[1]
        fake_CP      = fake_adress[1].split(&#39; &#39;)[0]
        fake_adresse = fake_adress[0]

        fake_name   = fake.name().split(&#39; &#39;, 1) # [&#39;Audrey&#39;, &#39;de Clerc&#39;]

        fake_nom       = fake_name[1]
        fake_prenom    = fake_name[0]
        fake_civilite  = fake.civilite()

        fake_secteur = randint(1,5)
        fake_coef    = randint(1,10)
        sql = f&#34;&#34;&#34;INSERT INTO Praticiens(Prenom, Nom, Civilite, Adresse, CP, Ville, CoefNotoriete, Secteur_id) 
        VALUES (&#39;{fake_prenom}&#39;, &#39;{fake_nom}&#39;, &#39;{fake_civilite}&#39;, &#39;{fake_adresse}&#39;, &#39;{fake_CP}&#39;,&#39; {fake_ville}&#39;, &#39;{fake_coef}&#39;, &#39;{fake_secteur}&#39;)&#34;&#34;&#34;
        query(sql)



    return &#34;50 praticiens insérés&#34;

@app.route(&#34;/faker/CR/&lt;int:Id&gt;&#34;)
def fake_cr(Id = 0):
    &#34;&#34;&#34;
    Genere 50 faux comptes rendus
    &#34;&#34;&#34;
    fake  = Faker(&#34;fr_FR&#34;)
    fake2 = Faker(&#39;it_IT&#39;)
    
    sql = &#34;SELECT Id FROM Praticiens&#34;
    praticien_ids = [el[&#34;Id&#34;] for el in query(sql)]
    provider = DynamicProvider(provider_name=&#34;praticien&#34;, elements=praticien_ids)
    fake.add_provider(provider)

    sql = &#34;SELECT Id FROM Visiteurs&#34;
    visiteur_ids = [el[&#34;Id&#34;] for el in query(sql)]
    provider = DynamicProvider(provider_name=&#34;visiteur&#34;, elements=visiteur_ids)
    fake.add_provider(provider)

    sql = &#34;SELECT Id FROM Medicaments&#34;
    medocs_ids = [el[&#34;Id&#34;] for el in query(sql)]
    provider = DynamicProvider(provider_name=&#34;medicament&#34;, elements=medocs_ids)
    fake.add_provider(provider)

    for i in range(10):
        pract_id = fake.praticien()
        if Id == 0:
            visit_id = fake.visiteur()
        else :
            visit_id = Id
        date     = fake.date_between(&#39;-10y&#39;,&#39;today&#39;).strftime(&#34;%d/%m/%Y&#34;)
        motif    = &#34;Visite&#34;
        bilan    = fake2.text(500)

        # sql = &#34;SELECT seq FROM sqlite_sequence WHERE name = &#39;Compte_rendu&#39;&#34;
        # Id = query(sql)[&#34;seq&#34;] + 1

        query_CR    = &#34;INSERT INTO Compte_rendu(Medecin_id, Date, Motif, Bilan, Visiteur_id) VALUES (?,?,?,?,?)&#34;
        Id = query(query_CR, (pract_id, date, motif, bilan, visit_id))
        

        # print(cursor.lastrowid)
        liste_echantillon = []
        for y in range(randint(1,10)):
            medicament  = fake.medicament()
            while medicament in liste_echantillon:
                medicament  = fake.medicament()
            liste_echantillon += [medicament]

            nombre      = randint(1,5)
            query_Medoc = &#34;INSERT INTO Echantillons(Medicaments_id, Cr_id, Nombre) VALUES (?,?,?)&#34;
            # print(medicament,Id)
            query(query_Medoc, (medicament, Id, nombre))


        
    return &#34;10 comptes rendus créés&#34;

@app.route(&#34;/faker/visiteur&#34;)
def fake_visiteur():
    &#34;&#34;&#34;
    Génère 50 faux visiteurs
    &#34;&#34;&#34;
    fake  = Faker(&#34;fr_FR&#34;)
    output = &#39;&#39;
    for i in range(50):
        date = fake.date_between(&#39;-10y&#39;,&#39;today&#39;)
        date_embauche = date.strftime(&#34;%d/%m/%Y&#34;)
        mdp  = date.strftime(&#34;%d-%b-%Y&#34;)
        mdp  = str(hashlib.md5(mdp.encode(&#34;utf-8&#34;)).hexdigest())

        fake_name      = fake.name().split(&#39; &#39;, 1) # [&#39;Audrey&#39;, &#39;de Clerc&#39;]
        fake_nom       = fake_name[1]
        fake_prenom    = fake_name[0]

        login = remove_accents(fake_nom).replace(&#39; &#39;, &#39;&#39;)
        admin = 1
        secteur = randint(1,5)

        sql = &#34;INSERT INTO Visiteurs(login,password,Secteur_id, nom, prenom, date_embauche, admin) VALUES(?,?,?,?,?,?,?)&#34;
        try:
            query(sql, (login, mdp, secteur, fake_nom, fake_prenom, date_embauche, admin))
        except Exception as e:
            pass
        output += f&#39;&lt;br&gt; {login} {mdp} {secteur} {fake_nom} {fake_prenom} {date_embauche} {admin} &#39;
        
    return output

        

    



######################################################################






# Test des différentes URL, mettre en paramètre de la fonction url_for() le nom de la fonction appelé pour une ROUTE.
# le debug s&#39;affiche sur la console du serveur
# if (str(app.config[&#39;ENV&#39;]) == &#39;development&#39;):
#     with app.test_request_context():
#         try:
#             url_for(&#39;medecin_all&#39;)
#             url_for(&#39;medecin&#39;, Id=1)
#             url_for(&#39;medicaments&#39;)
#             url_for(&#39;medicament&#39;, Id=1)
#             url_for(&#39;CR&#39;, Id=1)
#             url_for(&#39;cr_by_visiteur&#39;, Id=1)
#             url_for(&#39;cr_by_medecin&#39;, Id=1)
#         except Exception as e:
#             print(f&#34;/!\\ /!\\ /!\\ ERREUR /!\\ /!\\ /!\\ \n################################# \n{e} \n#################################&#34;)


if __name__ == &#39;__main__&#39;:
    app.run(host=&#34;0.0.0.0&#34;,port=5000,debug=True)


# **NOTES**
# On peut donner Plusieurs fois la même &#34;route&#34; mais en cas de conflit c&#39;est la première qui sera prise en compte </code></pre>
</details>
</section>
<section>
</section>
<section>
</section>
<section>
<h2 class="section-title" id="header-functions">Functions</h2>
<dl>
<dt id="gsb.Insert_CR"><code class="name flex">
<span>def <span class="ident">Insert_CR</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>fonction pour créer un compte rendu, la route attend un JSON </p>
<p>method:
POST</p>
<h2 id="param">Param</h2>
<p>JSON : contient les informations du compte rendu, il doit comporter les champs ["Medecin", "Date", "Motif", "Bilan", "Medoc"]</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>HTTP CODE</code></dt>
<dd>201, 400</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/GSB/CR/Insert&#34;, methods=[&#39;POST&#39;])
def Insert_CR():
    &#34;&#34;&#34;
    fonction pour créer un compte rendu, la route attend un JSON 

    method:
        POST

    Param:
        JSON : contient les informations du compte rendu, il doit comporter les champs [&#34;Medecin&#34;, &#34;Date&#34;, &#34;Motif&#34;, &#34;Bilan&#34;, &#34;Medoc&#34;]
    
    Returns:
        HTTP CODE: 201, 400
    &#34;&#34;&#34;
    get_session()
    cr = request.get_json()
    
    if not cr :
        if request.headers[&#39;Content-Type&#39;] != &#39;application/json&#39;:
                return &#39;Le Content-Type doit être application/json&#39;, 400
        else :
                abort(400)

    filtre = [&#34;Medecin&#34;, &#34;Date&#34;, &#34;Motif&#34;, &#34;Bilan&#34;, &#34;Medoc&#34;]

    for el in filtre:
        if el not in cr.keys():
                return &#39;Il manque &#34;&#39;+ el +&#39;&#34; dans le JSON&#39;, 400
    try:
        datetime.datetime.strptime(cr[&#34;Date&#34;], &#34;%d/%m/%Y&#34;)
    except ValueError:
        return &#34;La Date n&#39;est pas au bon format, le bon format est : DD/MM/YYYY&#34;, 400

    # print(cr)
    
    # exemple : {&#34;Medecin&#34;: 1, &#34;Date&#34;: &#34;21/07/2021&#34;, &#34;Motif&#34;: &#34;Visite&#34;, &#34;Bilan&#34;: &#34;Bla Bla Bla...&#34;, &#34;Medoc&#34;: {&#34;1&#34;: 1, &#34;2&#34; : 1, &#34;3&#34; : 5}}
    
    query_CR    = &#34;INSERT INTO Compte_rendu(Medecin_id, Date, Motif, Bilan, Visiteur_id) VALUES (?,?,?,?,? )&#34;
    Id = query(query_CR, (cr[&#34;Medecin&#34;], cr[&#34;Date&#34;], cr[&#34;Motif&#34;], cr[&#34;Bilan&#34;], session[&#34;id&#34;]))

    if cr[&#34;Medoc&#34;] :
        query_Medoc = &#34;INSERT INTO Echantillons(Medicaments_id, Cr_id, Nombre) VALUES (?,?,?)&#34;
        Medoc_list  = []
        for medoc_id, nombre in cr[&#34;Medoc&#34;].items():
            Medoc_list += [(medoc_id, Id, nombre)]

        query(query_Medoc, Medoc_list, many=True)

    log(f&#34;Compte rendu inséré avec l&#39;id : {Id}&#34;)

    return f&#34;Compte rendu inséré avec l&#39;id : {Id}&#34;, 201</code></pre>
</details>
</dd>
<dt id="gsb.connexion"><code class="name flex">
<span>def <span class="ident">connexion</span></span>(<span>db_name)</span>
</code></dt>
<dd>
<div class="desc"><p>Fonction de connexion à la base de donnée, elle est appelé à chaque nouvelle connexion.</p>
<p>!!! Le driver ODBC SQLite3 est necessaire à son execution.</p>
<p>!!! La base de donnée doit impérativement se trouver dans ./BDD/</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>db_name</code></strong> :&ensp;<code>string</code></dt>
<dd>le nom de la base de donnée à laquelle se connecter</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>object</code></dt>
<dd>objet pyodbc</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def connexion(db_name):
    &#34;&#34;&#34;
    Fonction de connexion à la base de donnée, elle est appelé à chaque nouvelle connexion.\n
    !!! Le driver ODBC SQLite3 est necessaire à son execution.\n
    !!! La base de donnée doit impérativement se trouver dans ./BDD/

    Args:
        db_name (string): le nom de la base de donnée à laquelle se connecter
    
    Returns:
        object: objet pyodbc 
    &#34;&#34;&#34;
    
    
    if app.config[&#39;DATABASE&#39;] == &#39;SQLITE&#39;:
        dir_path = &#39;./BDD/&#39;
        db_path  = dir_path + db_name
        cnxn = pyodbc.connect(&#34;Driver=SQLite3 ODBC Driver;Database=&#34; + db_path)
    
    elif app.config[&#39;DATABASE&#39;] == &#39;MYSQL&#39;:
        username = &#34;gsb&#34;
        password = &#34;157rmllp&#34;
        database = &#34;Applivisiteur&#34;
        driver   = &#34;MariaDB ODBC 3.0 Driver&#34;
        server   = &#34;localhost&#34;
        cnxn = pyodbc.connect(f&#34;Driver={driver};Database={database};Server={server};Uid={username};pwd={password}&#34;)

    elif app.config[&#39;DATABASE&#39;] == &#39;HOME&#39;:
        username = &#34;root&#34;
        password = &#34;157rmllp&#34;
        database = &#34;applivisiteur&#34;
        driver   = &#34;MySQL ODBC 8.0 Unicode Driver&#34;
        server   = &#34;localhost&#34;
        cnxn = pyodbc.connect(f&#34;Driver={driver};Database={database};Server={server};Uid={username};pwd={password}&#34;)
    
    return cnxn</code></pre>
</details>
</dd>
<dt id="gsb.cr_by_medecin"><code class="name flex">
<span>def <span class="ident">cr_by_medecin</span></span>(<span>Id)</span>
</code></dt>
<dd>
<div class="desc"><p>Recherche de compte rendu par medecin.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>Id</code></strong> :&ensp;<code>int</code></dt>
<dd>id du medecin</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>string</code></dt>
<dd>JSON contenant toutes les informations du compte rendu ainsi que les échantillons associés</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/GSB/CR/medecin/&lt;int:Id&gt;/&#34;)
def cr_by_medecin(Id):
    &#34;&#34;&#34;
    Recherche de compte rendu par medecin.
    
    Args:
        Id (int): id du medecin
    
    Returns:
        string: JSON contenant toutes les informations du compte rendu ainsi que les échantillons associés
    &#34;&#34;&#34;
    get_session()
    sql_CR = &#34;&#34;&#34;
    SELECT CR.Id, M.Civilite || &#39; &#39; || M.Nom || &#39; &#39; || M.Prenom AS Medecin,  CR.Date, CR.Motif, CR.Bilan
    FROM Compte_rendu CR
    JOIN Praticiens M ON CR.Medecin_id = M.Id
    WHERE CR.Medecin_id = &#34;&#34;&#34; + str(Id)

    result_CR = query(sql_CR) 
    if not result_CR:
        return Response(&#39;{&#34;error&#34; : &#34;Aucun enregistrement pour l\&#39;ID &#39; + str(Id) + &#39;&#34;}&#39;, status=404, mimetype=&#39;application/json&#39;)

    cpt = 0
    for cr in result_CR : 
        sql_Medoc = &#34;&#34;&#34;
        SELECT Medicaments.Label, Echantillons.Nombre
        FROM Echantillons
        JOIN Medicaments ON Echantillons.Medicaments_id = Medicaments.Id
        WHERE Echantillons.CR_id = &#34;&#34;&#34; + str(cr[&#34;Id&#34;])

        result_Medoc = query(sql_Medoc)

        if result_Medoc:
            result_CR[cpt][&#34;Medoc&#34;] = result_Medoc
        
        cpt+=1
    
    return Response(json.dumps(result_CR), status=200, mimetype=&#39;application/json&#39;)</code></pre>
</details>
</dd>
<dt id="gsb.cr_by_visiteur"><code class="name flex">
<span>def <span class="ident">cr_by_visiteur</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Recherche de compte rendu par visiteur.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>string</code></dt>
<dd>JSON contenant toutes les informations du compte rendu ainsi que les échantillons associés</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/GSB/CR/visiteur&#34;)
def cr_by_visiteur():
    &#34;&#34;&#34;
    Recherche de compte rendu par visiteur.

    Returns:
       string: JSON contenant toutes les informations du compte rendu ainsi que les échantillons associés 
    &#34;&#34;&#34;
    get_session()
    if app.config[&#34;DATABASE&#34;] == &#34;SQLITE&#34;:
        sql_CR = &#34;&#34;&#34;
        SELECT CR.Id, M.Civilite || &#39; &#39; || M.Nom || &#39; &#39; || M.Prenom AS Medecin,  CR.Date, CR.Motif, CR.Bilan
        FROM Compte_rendu CR
        JOIN Praticiens M ON CR.Medecin_id = M.Id
        WHERE CR.Visiteur_id = &#34;&#34;&#34; + str(session[&#34;id&#34;])
    else:
        sql_CR = &#34;&#34;&#34;
        SELECT CR.Id, CONCAT(M.Civilite,&#39; &#39;,M.Nom,&#39; &#39;,M.Prenom) AS Medecin,  CR.Date, CR.Motif, CR.Bilan
        FROM Compte_rendu CR
        JOIN Praticiens M ON CR.Medecin_id = M.Id
        WHERE CR.Visiteur_id = &#34;&#34;&#34; + str(session[&#34;id&#34;])


    result_CR = query(sql_CR)
    # print(result_CR)
    result_CR = {cr[&#34;Id&#34;] : cr for cr in result_CR}
    # print(result_CR)
    if not result_CR:
        return Response(&#39;{&#34;error&#34; : &#34;Aucun enregistrement pour l\&#39;utilisateur &#39; + str(session[&#34;id&#34;]) + &#39;&#34;}&#39;, status=200, mimetype=&#39;application/json&#39;)
    cpt = 0
    for Id in result_CR :
        cr = result_CR[Id]
        sql_Medoc = &#34;&#34;&#34;
        SELECT Medicaments.Label, Echantillons.Nombre
        FROM Echantillons
        JOIN Medicaments ON Echantillons.Medicaments_id = Medicaments.Id
        WHERE Echantillons.CR_id = &#34;&#34;&#34; + str(cr[&#34;Id&#34;])

        result_Medoc = query(sql_Medoc)
        if result_Medoc:

            if isinstance(result_Medoc,  dict):
                result_CR[Id][&#34;Medoc&#34;] = [result_Medoc]
            else:
                result_CR[Id][&#34;Medoc&#34;] = result_Medoc

        else:
            result_CR[Id][&#34;Medoc&#34;] = []
        cpt+=1
    
    return Response(json.dumps(result_CR), status=200, mimetype=&#39;application/json&#39;)</code></pre>
</details>
</dd>
<dt id="gsb.fake_cr"><code class="name flex">
<span>def <span class="ident">fake_cr</span></span>(<span>Id=0)</span>
</code></dt>
<dd>
<div class="desc"><p>Genere 50 faux comptes rendus</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/faker/CR/&lt;int:Id&gt;&#34;)
def fake_cr(Id = 0):
    &#34;&#34;&#34;
    Genere 50 faux comptes rendus
    &#34;&#34;&#34;
    fake  = Faker(&#34;fr_FR&#34;)
    fake2 = Faker(&#39;it_IT&#39;)
    
    sql = &#34;SELECT Id FROM Praticiens&#34;
    praticien_ids = [el[&#34;Id&#34;] for el in query(sql)]
    provider = DynamicProvider(provider_name=&#34;praticien&#34;, elements=praticien_ids)
    fake.add_provider(provider)

    sql = &#34;SELECT Id FROM Visiteurs&#34;
    visiteur_ids = [el[&#34;Id&#34;] for el in query(sql)]
    provider = DynamicProvider(provider_name=&#34;visiteur&#34;, elements=visiteur_ids)
    fake.add_provider(provider)

    sql = &#34;SELECT Id FROM Medicaments&#34;
    medocs_ids = [el[&#34;Id&#34;] for el in query(sql)]
    provider = DynamicProvider(provider_name=&#34;medicament&#34;, elements=medocs_ids)
    fake.add_provider(provider)

    for i in range(10):
        pract_id = fake.praticien()
        if Id == 0:
            visit_id = fake.visiteur()
        else :
            visit_id = Id
        date     = fake.date_between(&#39;-10y&#39;,&#39;today&#39;).strftime(&#34;%d/%m/%Y&#34;)
        motif    = &#34;Visite&#34;
        bilan    = fake2.text(500)

        # sql = &#34;SELECT seq FROM sqlite_sequence WHERE name = &#39;Compte_rendu&#39;&#34;
        # Id = query(sql)[&#34;seq&#34;] + 1

        query_CR    = &#34;INSERT INTO Compte_rendu(Medecin_id, Date, Motif, Bilan, Visiteur_id) VALUES (?,?,?,?,?)&#34;
        Id = query(query_CR, (pract_id, date, motif, bilan, visit_id))
        

        # print(cursor.lastrowid)
        liste_echantillon = []
        for y in range(randint(1,10)):
            medicament  = fake.medicament()
            while medicament in liste_echantillon:
                medicament  = fake.medicament()
            liste_echantillon += [medicament]

            nombre      = randint(1,5)
            query_Medoc = &#34;INSERT INTO Echantillons(Medicaments_id, Cr_id, Nombre) VALUES (?,?,?)&#34;
            # print(medicament,Id)
            query(query_Medoc, (medicament, Id, nombre))


        
    return &#34;10 comptes rendus créés&#34;</code></pre>
</details>
</dd>
<dt id="gsb.fake_prat"><code class="name flex">
<span>def <span class="ident">fake_prat</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Génère 50 faux particiens</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/faker/praticien&#34;)
def fake_prat():
    &#34;&#34;&#34;
    Génère 50 faux particiens
    &#34;&#34;&#34;
    fake = Faker(&#34;fr_FR&#34;)
    provider = DynamicProvider(provider_name=&#34;civilite&#34;, elements=[&#34;Mr&#34;, &#34;Me&#34;])
    fake.add_provider(provider)

    for i in range(50):
        fake_adress = fake.address().split(&#39;\n&#39;) # [&#39;chemin Jacqueline Noël&#39;, &#39;22704 ThomasVille&#39;]
        
        fake_ville   = fake_adress[1].split(&#39; &#39;)[1]
        fake_CP      = fake_adress[1].split(&#39; &#39;)[0]
        fake_adresse = fake_adress[0]

        fake_name   = fake.name().split(&#39; &#39;, 1) # [&#39;Audrey&#39;, &#39;de Clerc&#39;]

        fake_nom       = fake_name[1]
        fake_prenom    = fake_name[0]
        fake_civilite  = fake.civilite()

        fake_secteur = randint(1,5)
        fake_coef    = randint(1,10)
        sql = f&#34;&#34;&#34;INSERT INTO Praticiens(Prenom, Nom, Civilite, Adresse, CP, Ville, CoefNotoriete, Secteur_id) 
        VALUES (&#39;{fake_prenom}&#39;, &#39;{fake_nom}&#39;, &#39;{fake_civilite}&#39;, &#39;{fake_adresse}&#39;, &#39;{fake_CP}&#39;,&#39; {fake_ville}&#39;, &#39;{fake_coef}&#39;, &#39;{fake_secteur}&#39;)&#34;&#34;&#34;
        query(sql)



    return &#34;50 praticiens insérés&#34;</code></pre>
</details>
</dd>
<dt id="gsb.fake_visiteur"><code class="name flex">
<span>def <span class="ident">fake_visiteur</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Génère 50 faux visiteurs</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/faker/visiteur&#34;)
def fake_visiteur():
    &#34;&#34;&#34;
    Génère 50 faux visiteurs
    &#34;&#34;&#34;
    fake  = Faker(&#34;fr_FR&#34;)
    output = &#39;&#39;
    for i in range(50):
        date = fake.date_between(&#39;-10y&#39;,&#39;today&#39;)
        date_embauche = date.strftime(&#34;%d/%m/%Y&#34;)
        mdp  = date.strftime(&#34;%d-%b-%Y&#34;)
        mdp  = str(hashlib.md5(mdp.encode(&#34;utf-8&#34;)).hexdigest())

        fake_name      = fake.name().split(&#39; &#39;, 1) # [&#39;Audrey&#39;, &#39;de Clerc&#39;]
        fake_nom       = fake_name[1]
        fake_prenom    = fake_name[0]

        login = remove_accents(fake_nom).replace(&#39; &#39;, &#39;&#39;)
        admin = 1
        secteur = randint(1,5)

        sql = &#34;INSERT INTO Visiteurs(login,password,Secteur_id, nom, prenom, date_embauche, admin) VALUES(?,?,?,?,?,?,?)&#34;
        try:
            query(sql, (login, mdp, secteur, fake_nom, fake_prenom, date_embauche, admin))
        except Exception as e:
            pass
        output += f&#39;&lt;br&gt; {login} {mdp} {secteur} {fake_nom} {fake_prenom} {date_embauche} {admin} &#39;
        
    return output</code></pre>
</details>
</dd>
<dt id="gsb.get_session"><code class="name flex">
<span>def <span class="ident">get_session</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Check si l'utilisateur s'est connecté avant d'accéder à une ressource (fonction appelée à chaque route).</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>bool</code></dt>
<dd>l'utilisateur est bien connecté</dd>
<dt><code>erreur</code></dt>
<dd>code http 401</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def get_session():
    &#34;&#34;&#34; 
    Check si l&#39;utilisateur s&#39;est connecté avant d&#39;accéder à une ressource (fonction appelée à chaque route).

    Returns:
        bool: l&#39;utilisateur est bien connecté
        erreur: code http 401
    &#34;&#34;&#34;
    if not &#34;id&#34; in session:
        log(&#34;A tenté d&#39;acceder à une ressource sans être connecté&#34;)
        abort(401)
    elif str(session[&#39;admin&#39;]) == &#39;0&#39;:
        log(&#34;l&#39;utilisateur n&#39;est pas autorisé à accéder à cette ressource&#34;)
        abort(401)
    log(&#34;l&#39;utilisateur à accedé à une ressources&#34;)
    return True</code></pre>
</details>
</dd>
<dt id="gsb.hashpass"><code class="name flex">
<span>def <span class="ident">hashpass</span></span>(<span>password)</span>
</code></dt>
<dd>
<div class="desc"><p>Affiche le hash d'une chaine de charatère</p>
<h2 id="args">Args</h2>
<p>password(string): mot de passe à asher</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>string</code></dt>
<dd>le mot de passe ashé</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/utils/hashpass/&lt;password&gt;/&#34;)
def hashpass(password):
    &#34;&#34;&#34;
    Affiche le hash d&#39;une chaine de charatère

    Args:
        password(string): mot de passe à asher
    
    Returns:
        string: le mot de passe ashé
    &#34;&#34;&#34;
    
    hash_password = hashlib.md5(password.encode(&#34;utf-8&#34;)).hexdigest()

    return str(hash_password)</code></pre>
</details>
</dd>
<dt id="gsb.hello"><code class="name flex">
<span>def <span class="ident">hello</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>S'execute lorsqu'on appelle la racine du serveur.
Redirige vers la route /links.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#39;/&#39;)
def hello():
    &#34;&#34;&#34;
    S&#39;execute lorsqu&#39;on appelle la racine du serveur.
    Redirige vers la route /links.
    
    &#34;&#34;&#34;

    return redirect(&#34;/links&#34;, code=302)</code></pre>
</details>
</dd>
<dt id="gsb.list_routes"><code class="name flex">
<span>def <span class="ident">list_routes</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Liste les routes existantes dans l'API.</p>
<h2 id="returns">Returns</h2>
<p>Un DOM HTML.</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/links&#34;)
def list_routes():
    &#34;&#34;&#34;
    Liste les routes existantes dans l&#39;API.
    
    Returns:
        Un DOM HTML.
    &#34;&#34;&#34;
    session[&#39;id&#39;] = 0
    session[&#39;admin&#39;] = 2
    routes = &#39;&#39;

    for rule in app.url_map.iter_rules():
        routes += &#34;&lt;a href=&#39;&#34; + str(rule) + &#34;&#39;&gt;&#34; + escape(str(rule)) + &#34;&lt;/a&gt;&#34;
        routes += &#34;&lt;br&gt;&#34;

    return routes</code></pre>
</details>
</dd>
<dt id="gsb.log"><code class="name flex">
<span>def <span class="ident">log</span></span>(<span>text, loglevel=0)</span>
</code></dt>
<dd>
<div class="desc"><p>Fonction de logging.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>text</code></strong> :&ensp;<code>string</code></dt>
<dd>le message du log</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def log(text, loglevel=0):
    &#34;&#34;&#34;
    Fonction de logging.

    Args:
        text (string): le message du log
    &#34;&#34;&#34;
    loglevel_label = {0 : &#34;INFO    &#34;, 1 : &#34;WARNING &#34;, 2 : &#34;ERROR   &#34;}

    date_heure = datetime.datetime.now().strftime(&#34;%d/%m/%Y %H:%M:%S&#34;)
    if &#34;username&#34; in session :
        username   = session[&#34;username&#34;].ljust(24)
    else:
        username   = &#34;None&#34;.ljust(24)
    url        = request.full_path.ljust(20)
    radr       = request.remote_addr
    entete     = date_heure + &#34; &#34; + username + &#34; &#34; + url + &#34; &#34; + radr + &#34; &#34;
    log        = entete + loglevel_label[loglevel] + text +&#34;\n&#34;
    with open(&#34;log/api.log&#34;, &#34;a&#34;) as f:
        f.write(log)</code></pre>
</details>
</dd>
<dt id="gsb.medecin"><code class="name flex">
<span>def <span class="ident">medecin</span></span>(<span>Id)</span>
</code></dt>
<dd>
<div class="desc"><p>Execute une recherche de praticien.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>Id</code></strong> :&ensp;<code>int</code></dt>
<dd>id du praticien concerné</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>string</code></dt>
<dd>JSON avec toutes les informations du praticien</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/GSB/medecin/&lt;int:Id&gt;/&#34;)
def medecin(Id):
    &#34;&#34;&#34;
    Execute une recherche de praticien.

    Args:
        Id (int): id du praticien concerné
    
    Returns:
        string: JSON avec toutes les informations du praticien
    &#34;&#34;&#34;
    get_session()
    sql = &#34;SELECT * FROM Praticiens WHERE Id = &#34; + str(Id) 
    results = query(sql)

    if not results :
        return Response(&#39;{&#34;erreur&#34; : &#34;Aucun enregistrement pour l\&#39;ID &#39; + str(Id) + &#39;&#34;}&#39;, status=404, mimetype=&#39;application/json&#39;)
    
    return Response(json.dumps(results), status=200, mimetype=&#39;application/json&#39;)</code></pre>
</details>
</dd>
<dt id="gsb.medecin_all"><code class="name flex">
<span>def <span class="ident">medecin_all</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Execute une recherche sur tout les praticiens.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>string</code></dt>
<dd>JSON avec toutes les informations de tous les praticiens</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/GSB/medecins&#34;)  #Praticiens
def medecin_all():
    &#34;&#34;&#34;
    Execute une recherche sur tout les praticiens.
    
    Returns:
        string: JSON avec toutes les informations de tous les praticiens
    &#34;&#34;&#34;
    get_session()
    sql = &#34;SELECT * from Praticiens ORDER BY Nom&#34;

    results = query(sql)
    
    return Response(json.dumps(results), status=200, mimetype=&#39;application/json&#39;)</code></pre>
</details>
</dd>
<dt id="gsb.medicament"><code class="name flex">
<span>def <span class="ident">medicament</span></span>(<span>Id)</span>
</code></dt>
<dd>
<div class="desc"><p>Execute une recherche de médicament.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>Id</code></strong> :&ensp;<code>int</code></dt>
<dd>id du médicament concerné</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>string</code></dt>
<dd>JSON avec toutes les informations du médicament</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/GSB/medicament/&lt;int:Id&gt;/&#34;)
def medicament(Id):
    &#34;&#34;&#34;
    Execute une recherche de médicament.

    Args:
        Id (int): id du médicament concerné
    
    Returns:
        string: JSON avec toutes les informations du médicament
    &#34;&#34;&#34;
    get_session()
    sql = &#34;SELECT * FROM Medicaments WHERE Id = &#34; + str(Id)

    result = query(sql)
    if result == 0:
        return Response(&#39;{&#34;error&#34; : &#34;Aucun enregistrement pour l\&#39;ID &#39; + str(Id) + &#39;&#34;}&#39;, status=404, mimetype=&#39;application/json&#39;)

    return Response(json.dumps(result), status=200, mimetype=&#39;application/json&#39;)</code></pre>
</details>
</dd>
<dt id="gsb.medicaments"><code class="name flex">
<span>def <span class="ident">medicaments</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Execute une recherche sur tout les médicaments.</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>string</code></dt>
<dd>JSON avec toutes les informations de tous les médicaments</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/GSB/medicaments&#34;)
def medicaments():
    &#34;&#34;&#34;
    Execute une recherche sur tout les médicaments.
    
    Returns:
        string: JSON avec toutes les informations de tous les médicaments
    &#34;&#34;&#34;
    get_session()
    sql = &#34;SELECT * FROM Medicaments&#34;

    result = query(sql)
    if result == 0:
        return Response(&#39;{&#34;error&#34; : &#34;Aucun enregistrement pour l\&#39;ID &#39; + str(Id) + &#39;&#34;}&#39;, status=404, mimetype=&#39;application/json&#39;)

    return Response(json.dumps(result), status=200, mimetype=&#39;application/json&#39;)</code></pre>
</details>
</dd>
<dt id="gsb.ping"><code class="name flex">
<span>def <span class="ident">ping</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Appelée pour tester la connexion à l'API</p></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/ping&#34;)
def ping():
    &#34;&#34;&#34;
    Appelée pour tester la connexion à l&#39;API
    &#34;&#34;&#34;
    log(&#39;PING&#39;)
    return &#34;Alive !&#34;,200</code></pre>
</details>
</dd>
<dt id="gsb.query"><code class="name flex">
<span>def <span class="ident">query</span></span>(<span>sql, arg=[], many=False)</span>
</code></dt>
<dd>
<div class="desc"><p>Fonction générale utilisée pour executer les requtêtes sql sur la base de donnée</p>
<h2 id="args">Args</h2>
<dl>
<dt>sql
(string): Ordre SQL à executer</dt>
<dt>arg
(list, optional): Liste des arguments de la requête SQL</dt>
<dt><strong><code>many</code></strong> :&ensp;<code>bool</code>, optional</dt>
<dd>booleen qui indique si il faut executer la requete pour chaques éléments de arg</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>dict</code></dt>
<dd>Retourne un dictionnaire avec le nom des champs de la table en clé et la valeur du champ en valeur.</dd>
<dt><code>bool</code></dt>
<dd>Si il n'y a aucun résultat à la requête retourne False</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def query(sql, arg=[], many=False):
    &#34;&#34;&#34;
    Fonction générale utilisée pour executer les requtêtes sql sur la base de donnée

    Args:
        sql  (string): Ordre SQL à executer
        arg  (list, optional): Liste des arguments de la requête SQL
        many (bool, optional): booleen qui indique si il faut executer la requete pour chaques éléments de arg
    
    Returns:
        dict: Retourne un dictionnaire avec le nom des champs de la table en clé et la valeur du champ en valeur.
        bool: Si il n&#39;y a aucun résultat à la requête retourne False
    &#34;&#34;&#34;
    try:
        cnxn   = connexion(&#39;api.db&#39;)
        cursor = cnxn.cursor()
    except pyodbc.Error as e:
        log(f&#34;error : {e}&#34;, 2)
        abort(500, f&#34;error : {e}&#34;)

    try:
        if arg:
            
            if many:
                cursor.executemany(sql,arg)
            else:
                cursor.execute(sql,*arg)    
        else:
            cursor.execute(sql)
    except pyodbc.Error as e:
        log(f&#39;error with query : \n {sql} \n |{arg}|&#39;, 2)
        cursor.rollback()
        log(f&#34;error : {e}&#34;, 2)
        abort(500, f&#34;error : {e}&#34;)

    cnxn.commit()

    if sql.split(&#34; &#34;)[0].upper() == &#34;INSERT&#34;:
        if app.config[&#39;DATABASE&#39;] in (&#34;HOME&#34;, &#34;MYSQL&#34;):
            cursor.execute(&#34;SELECT LAST_INSERT_ID()&#34;)
            res = cursor.fetchone()
            results = res[0]
        elif app.config[&#39;DATABASE&#39;] == &#34;SQLITE&#34;:
            sql = &#34;SELECT seq FROM sqlite_sequence WHERE name = &#39;Compte_rendu&#39;&#34;
            results = query(sql)[&#34;seq&#34;]

    else:

        try:
            res = cursor.fetchall()

            columns = [column[0] for column in cursor.description]
            results = []
            
            if len(res) &gt; 1:
                for row in res:
                    results.append(dict(zip(columns, row)))
            else:
                results = dict(zip(columns, res[0]))
        except Exception as e:
            results = 0

    cnxn.close()
    
    return results</code></pre>
</details>
</dd>
<dt id="gsb.remove_accents"><code class="name flex">
<span>def <span class="ident">remove_accents</span></span>(<span>input_str)</span>
</code></dt>
<dd>
<div class="desc"><p>Purge une chaine de caractères en enlevants les accents.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>input_str</code></strong> :&ensp;<code>string</code></dt>
<dd>la chaine à purger</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>string</code></dt>
<dd>input_str sans accents</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">def remove_accents(input_str):
    &#34;&#34;&#34;
    Purge une chaine de caractères en enlevants les accents.

    Args:
        input_str (string): la chaine à purger
    
    Returns:
        string: input_str sans accents
    &#34;&#34;&#34;
    nkfd_form = unicodedata.normalize(&#39;NFKD&#39;, input_str)
    return u&#34;&#34;.join([c for c in nkfd_form if not unicodedata.combining(c)])</code></pre>
</details>
</dd>
<dt id="gsb.se_connecter"><code class="name flex">
<span>def <span class="ident">se_connecter</span></span>(<span>)</span>
</code></dt>
<dd>
<div class="desc"><p>Route utilisée pour s'authentifier auprès de l'API</p>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>HTTP CODE</code></dt>
<dd>200, 401</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/GSB/connexion&#34;, methods=[&#39;GET&#39;])
def se_connecter():
    &#34;&#34;&#34;
    Route utilisée pour s&#39;authentifier auprès de l&#39;API
    
    Returns:
        HTTP CODE: 200, 401
    &#34;&#34;&#34;
    ressources = request.get_json()
    res      = query(&#34;SELECT password, id, Secteur_id, nom, prenom, admin FROM Visiteurs WHERE login = ? &#34;, (ressources[&#39;login&#39;],) )

    password      = ressources[&#34;password&#34;]
    hash_password = hashlib.md5(password.encode(&#34;utf-8&#34;)).hexdigest()


    if res:
        user_pass = res[&#34;password&#34;]
        if user_pass == hash_password:
            session[&#39;username&#39;] = ressources[&#39;login&#39;]
            session[&#39;id&#39;]       = res[&#39;id&#39;]
            session[&#39;secteur&#39;]  = res[&#39;Secteur_id&#39;]
            session[&#39;admin&#39;]    = res[&#39;admin&#39;]
            
            info_util = dict()
            info_util[&#34;id&#34;]      = res[&#34;id&#34;]
            info_util[&#34;nom&#34;]     = res[&#34;nom&#34;]
            info_util[&#34;prenom&#34;]  = res[&#34;prenom&#34;]
            info_util[&#39;secteur&#39;] = res[&#39;Secteur_id&#39;]

            log(&#34;UTILISATEUR CONNECTE&#34;)
            
            return Response(json.dumps(info_util), status=200, mimetype=&#39;application/json&#39;)
            return str(res[&#34;id&#34;])
        else:
            log(&#34;Tentative de connexion avec : &#34; + ressources[&#34;login&#34;])
            return &#34;Mauvais nom d&#39;utilisateur/mot de passe&#34;, 401
    else:
        log(&#34;Tentative de connexion avec : &#34; + ressources[&#34;login&#34;])
        return &#34;Mauvais nom d&#39;utilisateur/mot de passe&#34;, 401</code></pre>
</details>
</dd>
<dt id="gsb.secteur_by_visiteur"><code class="name flex">
<span>def <span class="ident">secteur_by_visiteur</span></span>(<span>Id)</span>
</code></dt>
<dd>
<div class="desc"><p>Recherche de Secteur par visiteur.</p>
<h2 id="args">Args</h2>
<dl>
<dt><strong><code>Id</code></strong> :&ensp;<code>int</code></dt>
<dd>id du visiteur</dd>
</dl>
<h2 id="returns">Returns</h2>
<dl>
<dt><code>integer</code></dt>
<dd>id du secteur</dd>
</dl></div>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">@app.route(&#34;/GSB/visiteur/secteur_id/&lt;int:Id&gt;/&#34;)
def secteur_by_visiteur(Id):
    &#34;&#34;&#34;
    Recherche de Secteur par visiteur.
    
    Args:
        Id (int): id du visiteur
    
    Returns:
        integer: id du secteur
    &#34;&#34;&#34;
    sql_sect = &#34;&#34;&#34;
    SELECT Secteur_id
    FROM Visiteurs
    WHERE id = &#34;&#34;&#34; + str(Id)


    result_sect = query(sql_sect)
    return str(result_sect[&#34;Secteur_id&#34;])
    cursor.close()</code></pre>
</details>
</dd>
</dl>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul></ul>
</div>
<ul id="index">
<li><h3><a href="#header-functions">Functions</a></h3>
<ul class="two-column">
<li><code><a title="gsb.Insert_CR" href="#gsb.Insert_CR">Insert_CR</a></code></li>
<li><code><a title="gsb.connexion" href="#gsb.connexion">connexion</a></code></li>
<li><code><a title="gsb.cr_by_medecin" href="#gsb.cr_by_medecin">cr_by_medecin</a></code></li>
<li><code><a title="gsb.cr_by_visiteur" href="#gsb.cr_by_visiteur">cr_by_visiteur</a></code></li>
<li><code><a title="gsb.fake_cr" href="#gsb.fake_cr">fake_cr</a></code></li>
<li><code><a title="gsb.fake_prat" href="#gsb.fake_prat">fake_prat</a></code></li>
<li><code><a title="gsb.fake_visiteur" href="#gsb.fake_visiteur">fake_visiteur</a></code></li>
<li><code><a title="gsb.get_session" href="#gsb.get_session">get_session</a></code></li>
<li><code><a title="gsb.hashpass" href="#gsb.hashpass">hashpass</a></code></li>
<li><code><a title="gsb.hello" href="#gsb.hello">hello</a></code></li>
<li><code><a title="gsb.list_routes" href="#gsb.list_routes">list_routes</a></code></li>
<li><code><a title="gsb.log" href="#gsb.log">log</a></code></li>
<li><code><a title="gsb.medecin" href="#gsb.medecin">medecin</a></code></li>
<li><code><a title="gsb.medecin_all" href="#gsb.medecin_all">medecin_all</a></code></li>
<li><code><a title="gsb.medicament" href="#gsb.medicament">medicament</a></code></li>
<li><code><a title="gsb.medicaments" href="#gsb.medicaments">medicaments</a></code></li>
<li><code><a title="gsb.ping" href="#gsb.ping">ping</a></code></li>
<li><code><a title="gsb.query" href="#gsb.query">query</a></code></li>
<li><code><a title="gsb.remove_accents" href="#gsb.remove_accents">remove_accents</a></code></li>
<li><code><a title="gsb.se_connecter" href="#gsb.se_connecter">se_connecter</a></code></li>
<li><code><a title="gsb.secteur_by_visiteur" href="#gsb.secteur_by_visiteur">secteur_by_visiteur</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc" title="pdoc: Python API documentation generator"><cite>pdoc</cite> 0.10.0</a>.</p>
</footer>
</body>
</html>